(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(i){if(i.ep)return;i.ep=!0;const c=r(i);fetch(i.href,c)}})();const Y="https://docs.google.com/spreadsheets/d/e/2PACX-1vRUbvNSaRrEWnR67yD6RVyG3ypoeWJaJG9eBZ-f_cw7kOu4ZFSIBSHP4geWdtfQ_8zRzZTTi5h5Cw2d/pub?gid=1016263653&single=true&output=csv",O="./images/",Z="./icons/",ee=["Extended_Medium_Mag_III_00531083a8.png","Extended_Medium_Mag_II_2e66ba96e7.png","Extended_Light_Mag_III_d9347dc8af.png","Extended_Barrel_6f57d82e2b.png","Extended_Light_Mag_II_95a5cf317a.png","Explosive_Mine_f3f7dddb30.png","Complex_Gun_Parts_a4523a546f.png","Defibrillator_cbd07c7d0a.png","Compensator_II_9efd71b2c0.png","Compensator_III_0d2d5c294d.png","Combat_Mk._3__Flanking__b8b75b54bf.png","Combat_Mk._3__Aggressive__0c49a269d1.png","Bobcat-Level1_542f741fbd.png","Burletta-Level1_a959085f9a.png","Blaze_Grenade_b6c426c6f1.png","Barricade_Kit_b941aff2b2.png","Bettina_6c889eadf0.png","Aphelion_55eb3c8526.png","Angled_Grip_II_7b2a8db317.png","Angled_Grip_III_ba0d742697.png","Anvil-Level1_4008ab9b4c.png","Wolfpack_5d69c9575c.png","Vulcano-Level1_4e6ad17258.png","Vita_Spray_7142499abc.png","Vita_Shot_245f6df518.png","Vertical_Grip_III_e157ba22cd.png","Venator-Level1_f745282e98.png","Vertical_Grip_II_06f0877aa5.png","Trigger_Nade_a68e53c662.png","Torrente-Level1_4c179e6909.png","Tempest-Level1_3e74f4b8f2.png","Tagging_Grenade_76f0885a0b.png","Tactical_Mk._3__Healing__3e45bd6fe9.png","Tactical_Mk._3__Defensive__7ef33e823b.png","Stable_Stock_III_14dce56e4f.png","Stable_Stock_II_49853b0d73.png","Smoke_Grenade_d211fd4b6e.png","Snap_Hook_652f25b1ec.png","Silencer_I_e702af3150.png","Silencer_II_c3b8f6cd10.png","Showstopper_80e11cbf02.png","Shotgun_Silencer_e77598809f.png","Shotgun_Choke_II_0fb1aeefc5.png","Shotgun_Choke_III_d60e0aa440.png","Padded_Stock_2d6217c623.png","Remote_Raider_Flare_68128283b2.png","Osprey-Level1_14b1a9548e.png","Muzzle_Brake_III_d7c83e1c81.png","Medium_Gun_Parts_fb4d3a320f.png","Muzzle_Brake_II_65024a4a81.png","Lure_Grenade_fdb536acb5.png","Looting_Mk._3__Survivor__f49308eb27.png","Blue_Light_Stick_d11f5037e4.png","Lightweight_Stock_ff34cc3948.png","Light_Gun_Parts_48a0ac28f7.png","Jupiter_7c063c26c9.png","Jolt_Mine_4b49b4b521.png","Il_Toro-Level1_68a279b4f2.png","Hullcracker-Level1_487079afcf.png","Horizontal_Grip_0fc841c520.png","Heavy_Gun_Parts_7d1986dfd5.png","Equalizer_2299676690.png","Extended_Shotgun_Mag_III_ddfb6650ba.png","Extended_Shotgun_Mag_II_ccad252d22.png"],G=(()=>{const e=new Map;for(const t of ee){const n=t.replace(/\.png$/i,"").replace(/_[0-9a-f]{10}$/i,"");e.set(n,t)}return e})();function P(e){if(!e)return"";try{e=decodeURIComponent(e)}catch{}return e=e.replace(/\.webp$/i,"").replace(/\.png$/i,""),e=e.replace(/\(/g,"__").replace(/\)/g,""),e=e.replace(/['’]/g,""),e=e.replace(/\s+/g,"_"),e}function te(e,t){if(e&&(e.startsWith("./images/")||e.includes("/arcblueprinttracker/images/")))return e;let r="";e&&(r=e.split("?")[0].split("/").pop()||""),r=P(r);const n=P((t||"").trim()),i=[r,n];for(const c of i)if(c&&G.has(c))return O+G.get(c);for(const c of i)if(c){for(const[s,p]of G.entries())if(s===c||s.startsWith(c))return O+p}return e||""}const v={min:120,max:220,step:10,default:170,storageKey:"arc_gridSize_v2"},x={Common:{color:"#717471",rank:1},Uncommon:{color:"#41EB6A",rank:2},Rare:{color:"#1ECBFC",rank:3},Epic:{color:"#D8299B",rank:4},Legendary:{color:"#FBC700",rank:5}},W={Confirmed:x.Legendary.color,"Very High":x.Epic.color,Confident:x.Rare.color,Low:x.Uncommon.color,"Not Enough Data":"#E11D48"},ne=[{re:/weapon/i,file:"ItemCategory_Weapon.png"},{re:/grenade/i,file:"ItemCategory_Grenade.png"},{re:/quick\s*use|quickuse|consumable|med|healing|vita|tool|utility/i,file:"ItemCategory_QuickUse.png"},{re:/augment/i,file:"ItemCategory_Augment.png"},{re:/mod|attachment|barrel|muzzle|brake|choke|silencer|stock|grip|mag/i,file:"ItemCategory_Mod.png"},{re:/material|parts|craft|component/i,file:"ItemCategory_Material.png"},{re:/misc|key|trinket|other/i,file:"ItemCategory_Misc.png"}];function M(e){return Z+encodeURIComponent(e)}function $(e){const t=Math.max(v.min,Math.min(v.max,Number(e)||v.default));document.documentElement.style.setProperty("--cardSize",`${t}px`);const r=document.getElementById("grid");r&&(r.style.gridTemplateColumns=`repeat(auto-fill, minmax(${t}px, 1fr))`);try{localStorage.setItem(v.storageKey,String(t))}catch{}const n=document.getElementById("gridSizeLabel"),i=document.getElementById("gridSizeLabelMobile");n&&(n.textContent=`${t}px`),i&&(i.textContent=`${t}px`)}function oe(){try{const e=localStorage.getItem(v.storageKey);return e?Number(e):v.default}catch{return v.default}}function V(e){const t=(e||"").toString().trim(),r=t.toLowerCase().replace(/\s+/g,"");if(r==="weapon")return M("ItemCategory_Weapon.png");if(r==="grenade")return M("ItemCategory_Grenade.png");if(r==="quickuse")return M("ItemCategory_QuickUse.png");if(r==="mod")return M("ItemCategory_Mod.png");if(r==="augment")return M("ItemCategory_Augment.png");if(r==="material")return M("ItemCategory_Material.png");if(r==="misc")return M("ItemCategory_Misc.png");for(const n of ne)if(n.re.test(t))return M(n.file);return M("ItemCategory_Misc.png")}function re(e){const t=E(e);return t?/^https?:\/\//i.test(t)?t:M(t):""}function E(e){return(e??"").toString().trim()}function T(e){return E(e).toLowerCase()}function L(e,t){const r=e.map(n=>T(n));for(const n of t){const i=r.indexOf(T(n));if(i!==-1)return e[i]}for(const n of t){const i=T(n),c=r.findIndex(s=>s.includes(i));if(c!==-1)return e[c]}return null}function ie(e){const t=E(e);if(!t)return"";const r=t[0].toUpperCase()+t.slice(1).toLowerCase();if(x[r])return r;const n={Legend:"Legendary",Leg:"Legendary"};return n[r]?n[r]:r}function S(e){var t;return((t=x[e])==null?void 0:t.color)||"#3f3f46"}function w(e){var t;return((t=x[e])==null?void 0:t.rank)||0}const o={all:[],filtered:[],columns:{},filters:{rarities:new Set,types:new Set,maps:new Set,conds:new Set,confs:new Set,search:"",sort:"rarity_desc"},facets:{rarities:[],maps:[],types:[],conds:[],confs:[]}};function ce(){return new URL(window.location.href).searchParams.get("csv")||Y}function D(e){const t=document.getElementById("metaLine"),r=document.getElementById("metaLineMobile");t&&(t.textContent=e),r&&(r.textContent=e)}function ae(){const e=document.getElementById("drawer"),t=document.getElementById("openFiltersBtn"),r=document.getElementById("closeFiltersBtn"),n=document.getElementById("drawerBackdrop");function i(){e.classList.remove("hidden")}function c(){e.classList.add("hidden")}t&&(t.onclick=i),r&&(r.onclick=c),n&&(n.onclick=c);const s=document.getElementById("searchInput"),p=document.getElementById("searchInputMobile"),l=a=>{o.filters.search=a,b()};s&&s.addEventListener("input",a=>l(a.target.value)),p&&p.addEventListener("input",a=>{l(a.target.value),s&&(s.value=a.target.value)});const m=document.getElementById("sortSelect"),C=document.getElementById("sortSelectMobile"),k=a=>{o.filters.sort=a,m&&(m.value=a),C&&(C.value=a),b()};m&&(m.onchange=a=>k(a.target.value)),C&&(C.onchange=a=>k(a.target.value));const B=()=>{o.filters.rarities.clear(),o.filters.types.clear(),o.filters.maps.clear(),o.filters.conds.clear(),o.filters.confs.clear(),o.filters.search="",o.filters.sort="rarity_desc",s&&(s.value=""),p&&(p.value=""),m&&(m.value="rarity_desc"),C&&(C.value="rarity_desc"),b(),I()};["resetBtn","resetBtn2","resetBtnMobile"].forEach(a=>{const f=document.getElementById(a);f&&(f.onclick=B)});const y=(a,f)=>{const _=document.getElementById(a);_&&(_.onclick=()=>{f.clear(),b(),I()})};y("rarityAllBtn",o.filters.rarities),y("typeAllBtn",o.filters.types),y("mapAllBtn",o.filters.maps),y("condAllBtn",o.filters.conds),y("confAllBtn",o.filters.confs),y("rarityAllBtnMobile",o.filters.rarities),y("typeAllBtnMobile",o.filters.types),y("mapAllBtnMobile",o.filters.maps),y("condAllBtnMobile",o.filters.conds),y("confAllBtnMobile",o.filters.confs);const u=document.getElementById("gridSize"),h=document.getElementById("gridSizeMobile"),g=oe();$(g),u&&(u.min=String(v.min),u.max=String(v.max),u.step=String(v.step),u.value=String(g),u.addEventListener("input",a=>{const f=a.target.value;h&&(h.value=f),$(f)})),h&&(h.min=String(v.min),h.max=String(v.max),h.step=String(v.step),h.value=String(g),h.addEventListener("input",a=>{const f=a.target.value;u&&(u.value=f),$(f)}));const d=(a,f,_)=>{const A=document.getElementById(a),R=document.getElementById(f),z=document.getElementById(_);A&&R&&z&&(A.onclick=()=>{R.classList.toggle("hidden"),z.classList.toggle("rotate-180")})};d("toggleRarity","rarityFilters","iconRarity"),d("toggleType","typeFilters","iconType"),d("toggleMap","mapFilters","iconMap"),d("toggleCond","condFilters","iconCond"),d("toggleConf","confFilters","iconConf"),d("toggleRarityMobile","rarityFiltersMobile","iconRarityMobile"),d("toggleTypeMobile","typeFiltersMobile","iconTypeMobile"),d("toggleMapMobile","mapFiltersMobile","iconMapMobile"),d("toggleCondMobile","condFiltersMobile","iconCondMobile"),d("toggleConfMobile","confFiltersMobile","iconConfMobile")}function se(){D("Fetching sheet…");const e=ce();Papa.parse(e,{download:!0,header:!0,skipEmptyLines:!0,complete:t=>{var g;const r=t.data||[],n=((g=t.meta)==null?void 0:g.fields)||Object.keys(r[0]||{}),i=L(n,["Blueprint Name","Item Name","Name","Item"]),c=L(n,["Item Type","Type"]),s=L(n,["Item Type Icon","Type Icon","Item Type Icon URL","Type Icon URL","Item Type Icon File","Type Icon File"]),p=L(n,["Most Likely Map","Map"]),l=L(n,["Most Likely Condition","Condition"]),m=L(n,["Most Likely Location","Location"]),C=L(n,["Most Likely Container","Container"]),k=L(n,["Image URL","ImageURL","Icon URL","Thumbnail","Image"]),B=L(n,["Rarity","Item Rarity"]),y=L(n,["Data Confidence","Confidence"]),u=L(n,["Item URL","Wiki URL","URL","Link"]);o.columns={name:i,type:c,typeIcon:s,map:p,cond:l,loc:m,cont:C,img:k,rarity:B,conf:y,wiki:u};const h=[];for(const d of r){const a=E(d[i]);if(!a)continue;const f=E(d[c]),_=E(d[p]),A=E(d[l]),R=E(d[m]),z=E(d[C]),q=E(d[k]),j=te(q,a),K=ie(d[B]),J=y?E(d[y]):"",Q=E(d[u]),X=(s?re(d[s]):"")||V(f);h.push({name:a,type:f,map:_,cond:A,loc:R,cont:z,img:j,rarity:K,conf:J,wiki:Q,typeIcon:X})}o.all=h,le(),ae(),b(),I(),D(`${h.length} items • live from Sheets`)},error:t=>{console.error(t),D("Failed to load CSV. Check your published link.")}})}function F(e){const t=new Set(e.filter(r=>E(r)));return Array.from(t).sort((r,n)=>r.localeCompare(n))}const H=["Confirmed","Very High","Confident","Low","Not Enough Data"];function le(){o.facets.rarities=F(o.all.map(e=>e.rarity)).sort((e,t)=>w(t)-w(e)),o.facets.types=F(o.all.map(e=>e.type)),o.facets.maps=F(o.all.map(e=>e.map)),o.facets.conds=F(o.all.map(e=>e.cond)),o.facets.confs=F(o.all.map(e=>e.conf)).sort((e,t)=>{let r=H.indexOf(e),n=H.indexOf(t);return r===-1&&(r=999),n===-1&&(n=999),r-n})}function N(e,t){e.has(t)?e.delete(t):e.add(t)}function U(e,t,r){const n=document.createElement("button");return n.className="chip "+(t?"chip-active":""),n.textContent=e,n.onclick=r,n}function I(){const e={rarity:[document.getElementById("rarityFilters"),document.getElementById("rarityFiltersMobile")],type:[document.getElementById("typeFilters"),document.getElementById("typeFiltersMobile")],map:[document.getElementById("mapFilters"),document.getElementById("mapFiltersMobile")],cond:[document.getElementById("condFilters"),document.getElementById("condFiltersMobile")],conf:[document.getElementById("confFilters"),document.getElementById("confFiltersMobile")]};for(const t of e.rarity)if(t){t.innerHTML="";for(const r of o.facets.rarities){const n=o.filters.rarities.has(r),i=S(r),c=document.createElement("button");c.className="px-3 py-2 rounded-xl border text-xs font-semibold backdrop-blur-md transition-all hover:brightness-125";const s=n?i+"66":i+"22";c.style.background=s,c.style.borderColor=i,c.style.color="#f4f4f5",c.onclick=()=>{N(o.filters.rarities,r),b(),I()},c.textContent=r,t.appendChild(c)}}for(const t of e.type)if(t){t.innerHTML="";for(const r of o.facets.types){const n=o.filters.types.has(r),i=document.createElement("button");i.className="relative px-2 py-2 rounded-xl border hover:bg-zinc-800 flex items-center justify-center",i.style.borderColor=n?"rgb(113 113 122)":"rgb(39 39 42)",i.title=r,i.onclick=()=>{N(o.filters.types,r),b(),I()};const c=document.createElement("img");c.src=V(r),c.alt=r,c.className="w-6 h-6",i.appendChild(c),t.appendChild(i)}}for(const t of e.map)if(t){t.innerHTML="";for(const r of o.facets.maps){const n=o.filters.maps.has(r);t.appendChild(U(r,n,()=>{N(o.filters.maps,r),b(),I()}))}}for(const t of e.cond)if(t){t.innerHTML="";for(const r of o.facets.conds){const n=o.filters.conds.has(r);t.appendChild(U(r,n,()=>{N(o.filters.conds,r),b(),I()}))}}for(const t of e.conf)if(t){t.innerHTML="";for(const r of o.facets.confs){if(!r)continue;const n=o.filters.confs.has(r),i=W[r]||"#71717a",c=document.createElement("button");c.className="flex items-center gap-2 px-3 py-2 rounded-xl border text-xs hover:bg-zinc-800",c.style.borderColor=n?i:"rgb(39 39 42)",c.style.background=n?"rgba(255,255,255,0.04)":"rgb(24 24 27)",c.onclick=()=>{N(o.filters.confs,r),b(),I()};const s=document.createElement("span");s.className="confidence-dot",s.style.background=i;const p=document.createElement("span");p.textContent=r,c.appendChild(s),c.appendChild(p),t.appendChild(c)}}de()}function de(){const e=document.getElementById("activeChips");if(!e)return;e.innerHTML="";const t=(r,n)=>{const i=document.createElement("button");i.className="chip chip-active",i.textContent=r+" ✕",i.onclick=n,e.appendChild(i)};o.filters.rarities.size&&t(`Rarity: ${Array.from(o.filters.rarities).join(", ")}`,()=>{o.filters.rarities.clear(),b(),I()}),o.filters.types.size&&t(`Type: ${o.filters.types.size}`,()=>{o.filters.types.clear(),b(),I()}),o.filters.maps.size&&t(`Map: ${Array.from(o.filters.maps).join(", ")}`,()=>{o.filters.maps.clear(),b(),I()}),o.filters.conds.size&&t(`Condition: ${Array.from(o.filters.conds).join(", ")}`,()=>{o.filters.conds.clear(),b(),I()}),o.filters.confs.size&&t(`Confidence: ${Array.from(o.filters.confs).join(", ")}`,()=>{o.filters.confs.clear(),b(),I()}),o.filters.search.trim()&&t(`Search: ${o.filters.search.trim()}`,()=>{o.filters.search="";const r=document.getElementById("searchInput"),n=document.getElementById("searchInputMobile");r&&(r.value=""),n&&(n.value=""),b(),I()})}function b(){const e=T(o.filters.search),t=o.filters.rarities.size>0,r=o.filters.types.size>0,n=o.filters.maps.size>0,i=o.filters.conds.size>0,c=o.filters.confs.size>0;let s=o.all.filter(l=>!(t&&!o.filters.rarities.has(l.rarity)||r&&!o.filters.types.has(l.type)||n&&!o.filters.maps.has(l.map)||i&&!o.filters.conds.has(l.cond)||c&&!o.filters.confs.has(l.conf)||e&&!(l.name+" "+l.type+" "+l.map+" "+l.cond+" "+l.loc+" "+l.cont).toLowerCase().includes(e)));const p=o.filters.sort;s.sort((l,m)=>p==="name_asc"?l.name.localeCompare(m.name):p==="name_desc"?m.name.localeCompare(l.name):p==="type_asc"?(l.type||"").localeCompare(m.type||""):p==="map_asc"?(l.map||"").localeCompare(m.map||""):p==="rarity_desc"?w(m.rarity)-w(l.rarity)||l.name.localeCompare(m.name):p==="rarity_asc"&&w(l.rarity)-w(m.rarity)||l.name.localeCompare(m.name)),o.filtered=s,fe()}function fe(){const e=document.getElementById("grid"),t=document.getElementById("emptyState"),r=document.getElementById("resultCount");if(e){if(e.innerHTML="",r&&(r.textContent=`${o.filtered.length} / ${o.all.length}`),o.filtered.length)e.classList.remove("hidden"),t&&t.classList.add("hidden");else{e.classList.add("hidden"),t&&t.classList.remove("hidden");return}for(const n of o.filtered){const i=document.createElement("div");i.className="card-compact bg-zinc-950 border border-zinc-800 rounded-2xl p-2",i.style.position="relative",i.style.overflow="visible",i.style.position="relative",i.style.overflow="visible";const c=document.createElement("div");c.className="rarity-frame rarity-glow relative overflow-hidden",c.style.borderColor=S(n.rarity);const s=document.createElement("div");s.className="relative aspect-square rounded-[16px] flex items-center justify-center overflow-hidden",s.style.background=`linear-gradient(to top right, ${S(n.rarity)}44 0%, rgba(24,24,27,0.5) 75%)`,s.style.aspectRatio="1 / 1",s.style.width="100%";const p=document.createElement("img");p.src=n.img||"",p.alt=n.name,p.className="w-full h-full object-contain p-2 relative z-10",p.style.width="100%",p.style.height="100%",p.style.objectFit="contain",p.style.padding="8px",p.loading="lazy";const l=document.createElement("div");l.className="rarity-corner",l.style.background=`radial-gradient(circle at 120% -20%, transparent 0%, transparent 60%, ${S(n.rarity)}66 60%, ${S(n.rarity)}cc 100%)`;const m=document.createElement("div");m.className="type-tab",m.style.background=S(n.rarity)+"22",m.style.borderColor=S(n.rarity);const C=document.createElement("img");C.src=n.typeIcon,C.alt=n.type;const k=document.createElement("span");k.className="",k.textContent=n.type||"—",m.appendChild(C),m.appendChild(k),s.appendChild(p),s.appendChild(l),s.appendChild(m);const B=document.createElement("div");B.className="mt-2 px-1 pb-1";const y=document.createElement("div");y.className="font-semibold leading-tight",y.style.fontSize="clamp(13px, calc(var(--cardSize)/18), 16px)",y.textContent=n.name,B.appendChild(y);const u=document.createElement("div");u.className="details-overlay hidden";const h=(g,d)=>{if(!d)return null;const a=document.createElement("div");a.className="details-row";const f=document.createElement("div");f.className="details-label",f.textContent=g;const _=document.createElement("div");return _.className="details-value",_.textContent=d,a.appendChild(f),a.appendChild(_),a};if([h("Map",n.map),h("Location",n.loc),h("Container",n.cont),h("Condition",n.cond)].filter(Boolean).forEach(g=>u.appendChild(g)),n.conf){const g=document.createElement("div");g.className="details-row";const d=document.createElement("div");d.className="details-label",d.textContent="Data Confidence";const a=document.createElement("div");a.className="details-value details-confidence";const f=document.createElement("span");f.className="confidence-dot",f.style.background=W[n.conf]||"#71717a";const _=document.createElement("span");_.textContent=n.conf,a.appendChild(f),a.appendChild(_),g.appendChild(d),g.appendChild(a),u.appendChild(g)}if(n.wiki){const g=document.createElement("a");g.href=n.wiki,g.target="_blank",g.rel="noreferrer",g.className="mt-2 inline-block text-xs text-zinc-300 hover:text-white underline decoration-zinc-700",g.textContent="Open item page",u.appendChild(g)}c.style.cursor="pointer",c.onclick=g=>{g.stopPropagation();const d=!u.classList.contains("hidden");document.querySelectorAll(".details-overlay").forEach(a=>{if(a!==u){a.classList.add("hidden"),a.style.transform="";const f=a.closest(".card-compact");f&&f.classList.remove("card-open")}}),d?(u.classList.add("hidden"),u.style.transform="",i.classList.remove("card-open")):(u.classList.remove("hidden"),i.classList.add("card-open"),requestAnimationFrame(()=>{const a=u.getBoundingClientRect(),f=12;let _=0;a.left<f?_=f-a.left:a.right>window.innerWidth-f&&(_=window.innerWidth-f-a.right),_!==0&&(u.style.transform=`translateX(calc(-50% + ${_}px))`)}))},c.appendChild(s),i.appendChild(c),i.appendChild(B),i.appendChild(u),e.appendChild(i)}}}document.addEventListener("DOMContentLoaded",se);
